<div class="merchant-show row">

<%= render partial: "merchants/nav_aside" %>
<section class="small-8 columns">
<table>
  <thead>
    <tr>
      <th width="80">Order</th>
      <th width="200">Date</th>
      <th width="100">Product</th>
      <th width="100">Price</th>
      <th width="100">Quantity</th>
      <th width="100">Subtotal</th>
      <th width="100">Item Status</th>
      <th width="100">Order Status</th>
    </tr>
  </thead>
  <tbody>
    <% @order_items.each do |order_item| %>
    <tr>
      <td><%=link_to order_item.order_id, order_path(order_item.order_id)%></td>
      <td><%=order_item.created_at%></td>
      <td><%=link_to order_item.product.name, product_path(order_item.product_id)%></td>
      <td><%=order_item.product.price%></td>
      <td><%=order_item.quantity%></td>
      <td><%=order_item.subtotal%></td>
      <td>
        <% if order_item.order.status == "paid" && order_item.status == nil %>
          <%= link_to "Ship", order_item_path(order_item.id, :order_item => {:status => "Shipped" }), method: :patch, class: "button" %>
          <%= link_to "Cancel", order_item_path(order_item.id, :order_item => {:status => "Cancelled" }), method: :patch, class: "button" %>
        <% else %>
          <%=order_item.status%>
        <% end %>
      </td>
      <td><%=order_item.order.status%></td>
    </tr>

    <% end %>
    <tr class="total">
      <td colspan="4">total</td>
      <td><%=@merchant.order_items_quantity %></td>

      <td><%=@merchant.order_items_total%></td>
    </tr>
  </tbody>
</table>
</section>
</div>
