<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title><%= content_for?(:title) ? yield(:title) : "Untitled" %></title>

    <%= stylesheet_link_tag    "application" %>
    <%= javascript_include_tag "application", 'data-turbolinks-track' => true %>
    <%= csrf_meta_tags %>
  </head>

  <body>
    <header>
      <div class="page-header">
        <div class="row">
          <%= link_to image_tag('birdsy.png'), root_path %>
          <%= image_tag "cart-icon.png", class: "float-right" %>
        </div>
      </div>

      <nav class="row nav">
        <%= link_to "all products", products_path, class: "button" %>
        <div class="dropdown">
          <%= link_to "shop by merchant", merchants_path, class: "button" %>
          <div class="dropdown-content">
            <% Merchant.all.each do |merchant| %>
              <%= link_to merchant.username, products_merchant_path(merchant.id), class: "button" %>
            <% end %>
          </div>
        </div>
        <div class="dropdown">
          <%= link_to "shop by category", merchants_path, class: "button" %>
          <div class="dropdown-content">
            <% Category.all.each do |category| %>
              <%= link_to category.name, products_category_path(category.id), class: "button" %>
            <% end %>
          </div>
        </div>
        <% if session[:merchant_id] &&  Merchant.find_by(id: session[:merchant_id]) %>
          <div class="float-right">
          <%= link_to "logged in as #{Merchant.find(session[:merchant_id]).username}",merchant_path(session[:merchant_id]),class:"button"  %>
          <%= link_to "log out", logout_path, class: "button" %></div>
        <% else %>
          <%= link_to "login", '/auth/github', class: "button float-right" %>
        <% end %>
      </nav>
    </header>

    <main>
      <% if !flash.empty? %>
        <section class="row flash">
          <% if flash[:notice].present? %>
          <p><%= flash[:notice] %></p>
          <% end %>
          <% if flash[:details].present? %>
            <ul>
              <% flash[:details].each do |field, problems| %>
                <% problems.each do |problem| %>
                <li><strong>
                  <%= field %>:
                </strong>
                <%= problem %>
                </li>
                <% end %>
            <% end %>
            </ul>
          <% end %>
        </section>
      <% end %>


      <%= yield %>
    </main>

    <footer>
      <p>&copy; 2017, The Big Bird, Inc.</p>
    </footer>


  </body>
</html>
